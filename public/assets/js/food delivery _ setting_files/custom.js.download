var base_url = $('#mainurl').val();

$(document).ready(function ()
{
    $('.LoadingContainer').fadeOut(1000);

    $('.select2').select2({
        width: '100%',
        height: '100%',
    });

    $("#products-carousel").owlCarousel({
        items: 5,
        margin: 8,
        autoplay: true,
        autoplayTimeout: 2500,
        loop: true,
        responsive:
        {
            0: {
                items: 2
            },
            768: {
                items: 2
            },
            1200: {
                items: 5
            }
        }
    });

    $('.show_vendor_model_select2').select2(
    {
        width: '100%',
        height: '100%',
        dropdownParent: $('#insert_modal')
    });

    $('.privacy_policy').summernote({
        toolbar: [
            ['style', ['bold', 'italic', 'underline', 'clear']],
            ['font', ['strikethrough', 'superscript', 'subscript']],
            ['fontsize', ['fontsize']],
            ['color', ['color']],
            ['para', ['ul', 'ol', 'paragraph']],
            ['height', ['height']]
          ]
    });

    $("#start").timepicker({
        icons: {
            up: 'fas fa-chevron-up',
            down: 'fas fa-chevron-down'
        }
    });

    if (window.location.origin + window.location.pathname == $('#mainurl').val() + '/admin/home')
    {
        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/admin/orderChart',
            success: function (result)
            {
                orderChart(result);
            },
            error: function (err) {
                console.log('err ', err)
            }
        });

        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/admin/earningChart',
            success: function (result)
            {
                console.log('result',result);
                earningChart(result);
            },
            error: function (err) {
                console.log('err ', err)
            }
        });

        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/admin/topItems',
            success: function (result)
            {
                console.log('result',result);
                ItemsChart(result);
            },
            error: function (err) {
                console.log('err ', err)
            }
        });
    }

    if (window.location.origin + window.location.pathname == $('#mainurl').val() + '/vendor/vendor_home')
    {
        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/vendor/revenueChart',
            success: function (result)
            {
                console.log('result',result);
                revenueChart(result);
            },
            error: function (err) {
                console.log('err ', err)
            }
        });

        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/vendor/orderChart',
            success: function (result)
            {
                console.log('result',result);
                vendor_userChart(result);
            },
            error: function (err) {
                console.log('err ', err)
            }
        });
    }

    var today = new Date();

    var date = new Date();
    currentDate = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();

    var hours = date.getHours();
    var minutes = date.getMinutes();
    var ampm = hours >= 12 ? 'pm' : 'am';
    hours = hours % 12;
    hours = hours ? hours : 12; // the hour '0' should be '12'
    minutes = minutes < 10 ? '0' + minutes : minutes;
    var strTime = hours + ':' + minutes + '-' + ampm;
    $('.hidden_dateTime').val(currentDate + ' ' + strTime);

    $('#cp1').colorpicker();

    $(".flatpickr").flatpickr(
    {
        minDate: "today",
        enableTime: true,
        dateFormat: "Y-m-d h:i-K",
        minTime: strTime,
        defaultDate: currentDate + ' ' + strTime,
    });

    $(".flatpickr").change( function ()
    {
        $('.hidden_dateTime').val(this.value);
    });

    // $('.textarea_editor').summernote({
    //     "stylesheets": false,
    //     "size": 'small',
    //     "html": true,
    //     "format-code": true,
    //     "image": false,
    // });
    // $('.update_custimization').bind('click', function ()
    // {
    //     var i = $('input[name=custimization_type_id]').val();
    //     var name = $('input[name=custimization_type_name]').val();
    //     var name = name.replace(' ', '_');
    //     var tds = parseInt($("input[name='name"+name+"[]']").length);
    //     $('<tr id="custom'+i+'"><td><input type="text" name="name'+name+'[]" class="form-control" required placeholder="item"></td><td><input type="number" name="price[]" class="form-control" required placeholder="price"></td><td><input type="radio" name="isdefault_'+name+'" value="'+tds+'" id="'+i+'_'+tds+'"><label for="'+i+'_'+tds+'">&nbsp;Default</label></td><td><input type="checkbox" id="status'+i+'_'+tds+'" name="status'+tds+'"><label for="status'+i+'_'+tds+'">Status</label></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>').insertAfter($('#custom'+i+':nth-last-child('+tds+')'));
    // });

    $('.textarea_editor').summernote({
        toolbar: [
          ['style', ['bold', 'italic', 'underline', 'clear']],
          ['font', ['strikethrough', 'superscript', 'subscript']],
          ['fontsize', ['fontsize']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['height', ['height']]
        ]
      });

    $('.textarea_editor_term').summernote({
        toolbar: [
            ['style', ['bold', 'italic', 'underline', 'clear']],
            ['font', ['strikethrough', 'superscript', 'subscript']],
            ['fontsize', ['fontsize']],
            ['color', ['color']],
            ['para', ['ul', 'ol', 'paragraph']],
            ['height', ['height']]
          ]
    });

    $(function() {
        $('input[name="start_end_date"]').daterangepicker({
          opens: 'left',
          minDate: today,
          locale:
          {
            format: 'YYYY-MM-DD'
          },
        }, function(start, end, label)
        {
          $('#start_Period').val(start.format('YYYY-MM-DD'));
          $('#end_Period').val(end.format('YYYY-MM-DD'));
        });

        $('input[name="update_start_end_date"]').daterangepicker({
            opens: 'left',
            locale:
            {
              format: 'YYYY-MM-DD'
            },
          }, function(start, end, label)
          {
            $('#start_Period').val(start.format('YYYY-MM-DD'));
            $('#end_Period').val(end.format('YYYY-MM-DD'));
          });
    });

    var start_time = $('#start_time').val();
    var end_time = $('#end_time').val();
    var timeslot = $('#timeslot').val();

    $('.timeslots').timepicker({
        timeFormat: 'h:mm p',
        interval: timeslot,
        dynamic: false,
        dropdown: true,
        scrollbar: true,
        minTime: start_time,
        maxTime: end_time,
    });

    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        data:
        {
            user_id : $('select[name=user_id]').val(),
        },
        url: base_url + '/vendor/order/show_user_address',
        success: function (result)
        {
            if (result.data.length > 0)
            {
                $('select[name=address]').html('');
                $('select[name=address]').prop("disabled", false);
                result.data.forEach(element =>
                    {
                    $('select[name=address]').append('<option value="' + element.id + '">' + element.address + '</option>');
                });
                $('select[name=address]').trigger('change');
            }
            else
            {
                $('select[name=address]').html('');
                $('select[name=address]').prop("disabled", true);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });

    // $('select[name=order_status_change]').change(function()
    // {
    //     $.ajax(
    //     {
    //         headers:
    //         {
    //             'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
    //         },
    //         type: "POST",
    //         data:
    //         {
    //             id : $(this).attr("id"),
    //             status : this.value,
    //         },
    //         url: base_url + '/vendor/order/change_status',
    //         success: function (result)
    //         {
    //             if (result.success == true)
    //             {
    //                    location.reload();
    //             }
    //             else
    //             {

    //             }
    //         },
    //         error: function (err) {
    //             console.log('err ', err)
    //         }
    //     }); 
    // });

    $('input[name=qty_reset]').change(function()
    {
        console.log(this.value);
        if(this.value == 'daily')
        {
            $('input[name=item_reset_value]').prop("disabled", false);
        }
        else
        {
            $('input[name=item_reset_value]').prop("disabled", true);
        }
    });

    function readURL(input) {
        if (input.files && input.files[0])
        {
            var reader = new FileReader();
            reader.onload = function (e)
            {
                $('.logoContainer #image').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
		}
    }

	$("#previewImage").change(function(){
		readURL(this);
    });

	function readNatImg(input) {
        if (input.files && input.files[0])
        {
            var reader = new FileReader();
            reader.onload = function (e)
            {
                $('.logoContainer #national_identity').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
		}
    }

	$("#previewnational_identity").change(function(){
		readNatImg(this);
    });

    function readLicnDoc(input)
    {
        if (input.files && input.files[0])
        {
            var reader = new FileReader();
            reader.onload = function (e)
            {
                $('.logoContainer #licence_doc').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
		}
    }

	$("#previewlicence_doc").change(function(){
		readLicnDoc(this);
    });

    $('input[type=checkbox][name=verification_email]').change(function()
    {
        $('.setting_alert').hide();
        var user_verification = $('input[type=checkbox][name=verification]').is(":checked");
        var mail_verification = $('input[type=checkbox][name=verification_phone]').is(":checked");
        if(user_verification == true)
        {
            if(this.checked == false &&  mail_verification == false)
            {
                $('.setting_alert').show();
            }
        }
    });

    $('input[type=checkbox][name=verification_phone]').change(function()
    {
        $('.setting_alert').hide();
        var user_verification = $('input[type=checkbox][name=verification]').is(":checked");
        var mail_verification = $('input[type=checkbox][name=verification_email]').is(":checked");
        if(user_verification == true)
        {
            if(this.checked == false &&  mail_verification == false)
            {
                $('.setting_alert').show();
            }
        }
    });

    $('input[type=checkbox][name=business_availability]').change(function ()
    {
        if(this.checked == false)
        {
            $('.business_avai_msg').show();
        }
        else
        {
            $('.business_avai_msg').hide();
        }
    });

    $('input[type=checkbox][name=isAcceptMultiple]').change(function ()
    {
        if(this.checked == true)
        {
            $('.txtaccept_multiple').show();
        }
        else
        {
            $('.txtaccept_multiple').hide();
        }
    });

    $('select[name=delivery_type]').change(function ()
    {
        if (this.value == 'home')
        {
            $('.lblUser').show();
            $('.divUser').show();
        }
        else
        {
            $('.lblUser').hide();
            $('.divUser').hide();
        }

        $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "POST",
            data:
            {
                service_type : this.value,
                user_address: $('select[name=address]').val(),
                price: $('#hidden_price').val(),
            },
            url: base_url + '/vendor/order/distance',
            success: function (result)
            {
                var currency = $('.hidden_currency').val();
                var discount = $('.hidden_coupen_discount').val();
                if(discount == 0)
                {
                    if(result.success == true)
                    {
                        var hidden_price = parseInt($('#hidden_price').val());
                        var delivery_charge = parseInt(result.data.delivery_charge);
                        $('.delivery_charge').text(currency + delivery_charge);
                        $('.hidden_delivery_charge').val(delivery_charge);
                        $('.to_pay').text(currency + (hidden_price + delivery_charge));
                    }
                    else
                    {
                        $('select[name=delivery_type]').val('shop');
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: result.data,
                        });
                    }
                }
                else
                {
                    if(result.success == true)
                    {
                        var hidden_price = parseInt($('#hidden_price').val());
                        var delivery_charge = parseInt(result.data.delivery_charge);
                        $('.delivery_charge').text(currency + delivery_charge);
                        $('.hidden_delivery_charge').val(delivery_charge);
                        $('.to_pay').text(currency + ((hidden_price - discount)+delivery_charge));
                    }
                    else
                    {
                        $('select[name=delivery_type]').val('shop');
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: result.data,
                        });
                    }
                }
            },
            error: function (err)
            {
                console.log('err ', err)
            }
        });
    });

    $('select[name=user_id]').change(function ()
    {
        $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        data:
        {
            user_id : this.value,
        },
        url: base_url + '/vendor/order/show_user_address',
        success: function (result)
        {
            if (result.data.length > 0)
            {
                $('select[name=address]').html('');
                $('select[name=address]').prop("disabled", false);
                result.data.forEach(element =>
                    {
                    $('select[name=address]').append('<option value="' + element.id + '">' + element.address + '</option>');
                });
                $('select[name=address]').trigger('change');
            }
            else
            {
                $('select[name=address]').html('');
                $('select[name=address]').prop("disabled", true);
            }
            // console.log(result);
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
    });

    $('input[type=checkbox][name=customer_notification]').change(function ()
    {
        if(this.checked == true)
        {
            $('.customer_notification_card').show();
        }
        else
        {
            $('.customer_notification_card').hide();
        }
    });

    $('input[type=checkbox][name=vendor_notification]').change(function ()
    {
        if(this.checked == true)
        {
            $('.vendor_notification_card').show();
        }
        else
        {
            $('.vendor_notification_card').hide();
        }
    });

    $('input[type=checkbox][name=driver_notification]').change(function ()
    {
        if(this.checked == true)
        {
            $('.driver_notification_card').show();
        }
        else
        {
            $('.driver_notification_card').hide();
        }
    });

    $('input[type=checkbox][name=stripe]').change(function ()
    {
        if(this.checked == true)
        {
            $('.stripe_card').show();
        }
        else
        {
            $('.stripe_card').hide();
        }
    });

    $('input[type=checkbox][name=paypal]').change(function ()
    {
        if(this.checked == true)
        {
            $('.paypal_card').show();
        }
        else
        {
            $('.paypal_card').hide();
        }
    });

    $('input[type=checkbox][name=razorpay]').change(function ()
    {
        if(this.checked == true)
        {
            $('.razorpay_card').show();
        }
        else
        {
            $('.razorpay_card').hide();
        }
    });

    $('input[type=checkbox][name=razorpay]').change(function ()
    {
        if(this.checked == true)
        {
            $('.razorpay_card').show();
        }
        else
        {
            $('.razorpay_card').hide();
        }
    });

    $('input[type=checkbox][name=flutterwave]').change(function ()
    {
        if(this.checked == true)
        {
            $('.flutterwave_card').show();
        }
        else
        {
            $('.flutterwave_card').hide();
        }
    });

    $('input[type=checkbox][name=isFlat]').change(function ()
    {
        var checked = $('input[type=checkbox][name=isFlat]').is(":checked");
        if(checked == true)
        {
            $('.discountType').hide();
            $('.max_disc_amount').hide();
            $('.flatDiscount').show();
        }
        else
        {
            $('.discountType').show();
            $('.max_disc_amount').show();
            $('.flatDiscount').hide();
        }
    });

    $('input[type=checkbox][name=isItemTax]').change(function ()
    {
        var checked = this.checked;
        if(checked == true)
        {
            $('.txtItemTax').hide();
        }
        else
        {
            $('.txtItemTax').show();
        }
    });

    $('select[name=delivery_charge_type]').change(function () {
        if(this.value == 'order_amount')
        {
            $('.order_charge_table').show();
            $('.delivery_charge_table').hide();
        }
        if(this.value == 'delivery_distance')
        {
            $('.order_charge_table').hide();
            $('.delivery_charge_table').show();
        }
    });

    var table_length = $('.custimization_table').length;

    for (let i = 1; i <= table_length; i++)
    {
        $('#chkbox'+i).change(function ()
        {
            console.log(this.checked);
        });
    }

    $('input[type=checkbox][name=delivery_type]').change(function ()
    {
        if(this.checked == true)
        {
            $('.user_address_btn').show();
        }
        else
        {
            $('.user_address_btn').hide();
        }
    });

    $('input[type=checkbox][name=is_driver_accept_multipleorder]').change(function ()
    {
        if(this.checked == true)
        {
            $('.driver_accept_multi_order').show();
        }
        else
        {
            $('.driver_accept_multi_order').hide();
        }
    });

    $('input[type=checkbox][name=delivery_at]').change(function ()
    {
        if(this.checked == true)
        {
            $('#staticBackdrop').modal();
            $('#staticBackdrop').addClass('show');
        }
        else
        {
            $('#staticBackdrop').hide();
        }
    });

    $('select[id=order_promoCode]').change(function ()
    {
        // if(this.value != '')
        // {
            $.ajax(
            {
                headers:
                {
                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                },
                type: "POST",
                url: base_url + '/vendor/order/apply_coupen',
                data:
                {
                    promoCode_id: this.value,
                    price: $('#hidden_price').val(),
                    date: $('.hidden_dateTime').val(),
                },
                success: function (result)
                {
                    var currency = $('.hidden_currency').val();
                    if(result.success == true)
                    {
                        var delivery_charge = parseInt($('.hidden_delivery_charge').val());
                        var discount = parseInt($('.hidden_coupen_id').val());
                        if (delivery_charge != 0)
                        {
                            var discount = parseInt(result.data.discount);
                            var hidden_price = parseInt($('#hidden_price').val())
                            $('#hidden_promocode_price').val(discount);
                            $('.discount').text(currency + discount);
                            $('.hidden_coupen_discount').val(discount);
                            $('.hidden_coupen_id').val(result.data.coupen_id);
                            $('.to_pay').text(currency + ((hidden_price + delivery_charge) - discount));
                        }
                        else
                        {
                            var discount = parseInt(result.data.discount);
                            var hidden_price = parseInt($('#hidden_price').val());
                            $('#hidden_promocode_price').val(discount);
                            $('.discount').text(currency + discount);
                            $('.hidden_coupen_discount').val(discount);
                            $('.hidden_coupen_id').val(result.data.coupen_id);
                            $('.to_pay').text(currency + (hidden_price - discount));
                        }
                    }
                    else
                    {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: result.data,
                        });
                    }
                }
            });
        // }
        // else
        // {
        //     $('select[name=promocode_id]').val('');
        // }
    });

    $(document).on('click', 'button.removebtn', function ()
    {
        $(this).closest('tr').remove();
        return false;
    });

});

function orderChart(data)
{
    var appointment_chart = document.getElementById("orderChart").getContext('2d');
    var color = getComputedStyle(document.documentElement).getPropertyValue('--site_color');

    var myChart = new Chart(appointment_chart,
    {
        type: 'line',
        data:
        {
            labels: data.label,
            datasets: [{
                label: 'Orders',
                data: data.data,
                borderColor: 'black',
                backgroundColor: 'transparent',
                pointBackgroundColor: color,
                pointBorderColor: 'black',
                pointRadius: 4
            }]
        },
        options: {
            legend: {
                display: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        display: false ,
                        drawBorder: false,
                    },
                }],
                xAxes: [{
                    gridLines: {
                        color: '#fbfbfb',
                        lineWidth: 2
                    }
                }]
            },
        }
    });
}

function earningChart(data)
{
    var user_chart = document.getElementById("earningChart");
    var color = getComputedStyle(document.documentElement).getPropertyValue('--site_color');

    var myChart = new Chart(user_chart,
    {
        type: 'line',
        data:
        {
            labels: data.label,
            datasets: [{
                label: 'Earnings',
                data: data.data,
                // borderWidth: 5,
                borderColor: 'black',
                backgroundColor: 'transparent',
                pointBackgroundColor: color,
                pointBorderColor: 'black',
                pointRadius: 4
            }]
        },
        options: {
            legend: {
                display: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        display: false ,
                        drawBorder: false,
                    },
                }],
                xAxes: [{
                    gridLines: {
                        color: '#fbfbfb',
                        lineWidth: 2
                    }
                }]
            },
        }
    });
}

function vendor_userChart(data) {
    var user_chart = document.getElementById("userChart");
    var color = getComputedStyle(document.documentElement).getPropertyValue('--site_color');

    var myChart = new Chart(user_chart,
    {
        type: 'line',
        data:
        {
            labels: data.label,
            datasets: [{
                label: 'orders',
                data: data.data,
                // data: [10,20,35,40,58,62,77,80,90,100],
                borderWidth: 1,
                borderColor: 'black',
                backgroundColor: 'transparent',
                pointBackgroundColor: color,
                pointBorderColor: 'black',
                pointRadius: 4
            }]
        },
        options: {
            legend: {
                display: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        display: false ,
                        drawBorder: false,
                    },
                }],
                xAxes: [{
                    gridLines: {
                        color: '#fbfbfb',
                        lineWidth: 1
                    }
                }]
            },
        }
    });
}

function revenueChart(data) {
    var revenueChart = document.getElementById("revenueChart");
    var color = getComputedStyle(document.documentElement).getPropertyValue('--site_color');

    var myChart = new Chart(revenueChart,
    {
        type: 'line',
        data:
        {
            labels: data.label,
            datasets: [{
                label: 'orders',
                data: data.data,
                // data: [10,20,35,40,58,62,77,80,90,100],
                borderWidth: 1,
                borderColor: 'black',
                backgroundColor: 'transparent',
                pointBackgroundColor: color,
                pointBorderColor: 'black',
                pointRadius: 4
            }]
        },
        options: {
            legend: {
                display: false
            },
            scales: {
                yAxes: [{
                    gridLines: {
                        display: false ,
                        drawBorder: false,
                    },
                }],
                xAxes: [{
                    gridLines: {
                        color: '#fbfbfb',
                        lineWidth: 1
                    }
                }]
            },
        }
    });
}

function ItemsChart(data)
{
    var item = [];
    var count = [];
    for (let i = 0; i < data.items.length; i++)
    {
        item.push(data.items[i].itemName);
        count.push(data.items[i].total);
    }
    // console.log(item);
    var ctx = document.getElementById("topItems").getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        datasets: [{
          data: count,
          backgroundColor: [
            '#55D8FE',
            '#FF8373',
            '#FFDA83',
            '#A3A0FB',
          ],
          label: 'Dataset 1'
        }],
        labels: item,
      },
      options: {
        responsive: true,
        legend: {
          position: 'bottom',
        },
      }
    });
}

function VendororderChart(data)
{
    color = [];
    for (let i = 0; i < 7; i++)
    {
        color.push( 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')');
    }
    var appointment_chart = document.getElementById("myChart").getContext('2d');

    var myChart = new Chart(appointment_chart, {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [
                    // data.data.pending_order,
                    // data.data.accept,
                    // data.data.reject,
                    // data.data.pickup,
                    // data.data.delivered,
                    // data.data.cancel,
                    // data.data.complete
                    34,
                    56,
                    67,
                    23,
                    45,
                    11,
                    16
                ],
                backgroundColor: color,
                label: 'Dataset 1'
            }],
            labels: [
                'pending order',
                'Accept',
                'Reject',
                'pickup',
                'delivered',
                'Cancel',
                'complete'
            ],
        },
        options: {
            responsive: true,
            legend: {
                position: 'bottom',
            },
        }
    });
    // var user_chart = document.getElementById("userChart").getContext('2d');

    // var myChart = new Chart(user_chart,
    // {
    //     type: 'bar',
    //     data:
    //     {
    //         labels: data.label,
    //         datasets: [{
    //             label: 'Users',
    //             data: data.data,
    //             borderWidth: 5,
    //             borderColor: '#6777ef',
    //             backgroundColor: '#6777ef',
    //             // backgroundColor: 'transparent',
    //             pointBackgroundColor: '#fff',
    //             pointBorderColor: '#6777ef',
    //             pointRadius: 4
    //         }]
    //     },
    //     options: {
    //         legend: {
    //             display: true
    //         },
    //         scales: {
    //             yAxes: [{
    //                 gridLines: {
    //                     display: false ,
    //                     drawBorder: false,
    //                 },
    //             }],
    //             xAxes: [
    //             {
    //                 gridLines:
    //                 {
    //                     color: '#fbfbfb',
    //                     lineWidth: 2
    //                 }
    //             }]
    //         },
    //     }
    // });
}

var DatatableBasic = (function() {

    // Variables
    var $dtBasic = $('#datatable');

    // Methods
    function init($this) {
        var options = {
            keys: !0,
            select: {
                style: "multi"
            },
            language: {
                paginate: {
                    previous: "<i class='fas fa-angle-left'>",
                    next: "<i class='fas fa-angle-right'>"
                }
            },
        };

        // Init the datatable

        var table = $this.on( 'init.dt', function () {
            $('div.dataTables_length select').removeClass('custom-select custom-select-sm');

        }).DataTable(options);
    }

    // Events

    if ($dtBasic.length) {
        init($dtBasic);
    }

})();

var DatatableBasic = (function() {

    // Variables
    var $dtBasic = $('.datatable');

    // Methods

    function init($this)
    {
        var options =
        {
            "pageLength": 31,
            keys: !0,
            select: {
                style: "multi"
            },
            language: {
                paginate: {
                    previous: "<i class='fas fa-angle-left'>",
                    next: "<i class='fas fa-angle-right'>"
                }
            },
        };

        // Init the datatable

        var table = $this.on( 'init.dt', function () {
            $('div.dataTables_length select').removeClass('custom-select custom-select-sm');

        }).DataTable(options);
    }

    // Events

    if ($dtBasic.length)
    {
        init($dtBasic);
    }
})();

var DatatableBasic = (function() {

    // Variables
    var $dtBasic = $('.report');

    // Methods

    function init($this) {

        var options = {
            keys: !0,
            select: {
                style: "multi"
            },
            dom: 'Bfrtip',
            language: {
                paginate: {
                    previous: "<i class='fas fa-angle-left'>",
                    next: "<i class='fas fa-angle-right'>"
                }
            },
            buttons: [
                'copyHtml5',
                'excelHtml5',
                'csvHtml5',
                'pdfHtml5'
            ]
        };

        // Init the datatable

        var table = $this.on( 'init.dt', function () {
            $('div.dataTables_length select').removeClass('custom-select custom-select-sm');
        }).DataTable(options);
    }

    // Events

    if ($dtBasic.length) {
        init($dtBasic);
    }

})();

function update_custimization(i,name)
{
    // var name = name.replace(' ', '_');
    var name = name.split(' ').join('_');
    var tds = parseInt($("input[name='name"+name+"[]']").length);
    $('#custom'+i).append('<tr id="custom'+i+'"><td><input type="text" name="name'+name+'[]" class="form-control" required placeholder="item" style="text-transform: none;"></td><td><input type="number" name="price[]" class="form-control" required placeholder="price"></td><td><input type="radio" name="isdefault_'+name+'" value="'+tds+'" id="'+i+'_'+tds+'"><label for="'+i+'_'+tds+'">&nbsp;Default</label></td><td><input type="checkbox" id="status'+i+'_'+tds+'" name="status'+tds+'"><label for="status'+i+'_'+tds+'">Status</label></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>');
}

function add_field()
{
    $('.delivery_table').append('<tr><td><input type="number" required name="min_value[]" class="form-control"></td><td><input type="number" required name="max_value[]" class="form-control"></td><td><input type="number" required name="charges[]" class="form-control"></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>');
}

function add_cancel_reason()
{
    $('.cancel_reason').append('<tr><td><input type="text" name="cancel_reason[]" class="form-control" required></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>');
}

function add_drivervehical_field()
{
    $('.driver_vehical_table').append('<tr><td><input type="text" name="vehical_type[]" class="form-control" required></td><td><select name="license[]" class="form-control"><option value="yes">Yes</option><option value="no">no</option></select></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>');
}

function add_driverearning_field()
{
    $('.driver_earning_table').append('<tr><td><input type="number" name="min_km[]" class="form-control" required></td><td><input type="number" name="max_km[]" class="form-control" required></td><td><input type="number" name="charge[]" class="form-control" required></td><td><button type="button" class="btn btn-primary removebtn"><i class="fas fa-times"></i></button></td></tr>');
}

function addhours(i)
{
    var start_time = $('#start_time').val();
    var end_time = $('#end_time').val();
    var timeslot = $('#timeslot').val();
    $('#tr'+i).after('<tr><td><input class="timeslots" name="start_time_'+i+'[]" /></td><td><input class="timeslots" name="end_time_'+i+'[]"/></td><td><button type="button" class="removebtn btn btn-primary text-light">Remove</button></tr>');
    $('.timeslots').timepicker({
        timeFormat: 'h:mm p',
        defaultTime: '11',
        interval: timeslot,
        dynamic: false,
        dropdown: true,
        scrollbar: true,
        minTime: start_time,
        maxTime: end_time,
    });
}

function view_custimization(submenu_id)
{
    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/vendor/order/view_custimization/'+submenu_id,
        success: function (result)
        {
            console.log(result);
            if(result.success == true)
            {
                $('.custimization_name').html('');
                if(result.data.item.length > 0)
                {
                    $.each(result.data.item, function(i, element)
                    {
                        $('.custimization_name').append('<input type="hidden" name="submenu_id" value="'+element.submenu_id+'"><table class="table custimization_table"><tr><td class="cust_items'+i+'"><hr><input type="checkbox" value='+"custimization"+element.name+' id="chkbox'+i+'" name="custimization'+element.name+'"><label for="chkbox'+i+'">'+element.name+'</label><hr></td></tr></table>');
                        if (element.custimazation_item != null)
                        {
                            var c = JSON.parse(element.custimazation_item);
                            $.each(c, function (j, item) 
                            {
                                var check = '';
                                if (item.isDefault == 1) 
                                {
                                    check = 'checked';
                                }

                                $('.cust_items' + i).append('<tr class="radios' + i + '"><td><label for="radio' + j + '">' + item.name + '</label></td><td class="text-right w-100"><label for="radio' + j + '">' + result.currency + item.price + '</label>&nbsp;<input id="radio' + i + '_' + j + '" name="cust_item' + element.id + '" type="radio" ' + check + ' value="' + item.name + '_' + item.price + '"></td></tr>');

                                // if (result.data.session != "") 
                                // {
                                //     var s = JSON.parse(result.data.session);
                                //     $.each(s, function (k, session) 
                                //     {
                                //         if (session.main_menu == $('input[type=checkbox][name="custimization' + element.name + '"]').val()) 
                                //         {
                                //             $('input[type=checkbox][name="custimization' + element.name + '"]').prop("checked", true);
                                //         }
                                //         console.log(session.data.name + '_' + session.data.price == $('input[type=radio][id="radio' + i + '_' + j + '"]').val());
                                //         if (session.data.name + '_' + session.data.price == $('input[type=radio][id="radio' + i + '_' + j + '"]').val()) 
                                //         {
                                //             $('input[type=radio][id="radio' + i + '_' + j + '"]').prop("checked", true);
                                //         }
                                //     });
                                // }
                            });

                            if (result.data.session != "") 
                            {
                                $.each(c, function (j, item) 
                                {
                                    if (result.data.session != "") 
                                    {
                                        var s = JSON.parse(result.data.session);
                                        $.each(s, function (k, session) 
                                        {
                                            if (session.main_menu == $('input[type=checkbox][name="custimization' + element.name + '"]').val()) 
                                            {
                                                $('input[type=checkbox][name="custimization' + element.name + '"]').prop("checked", true);
                                            }
                                            if (session.data.name + '_' + session.data.price == $('input[type=radio][id="radio' + i + '_' + j + '"]').val()) 
                                            {
                                                $('input[type=radio][id="radio' + i + '_' + j + '"]').prop("checked", true);
                                            }
                                        });
                                    }
                                });
                            }
                        }
                        else
                        {
                            $('.custimization_name').append('No custimization available');
                        }
                    });
                }
                else
                {
                    $('.custimization_name').append('No custimization available');
                }
            }

        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_cust()
{
    var table_length = $('.custimization_table').length;
    var custimization = [];

    for (let i = 0; i < table_length; i++)
    {
        if ($('input[type=checkbox][id=chkbox'+i+']:checked').val() != undefined)
        {
            var radio_length = $('.radios'+i).length
            for (let j = 0; j < radio_length; j++)
            {
                if ($('input[type=radio][id=radio'+i+'_'+j+']:checked').val() != undefined)
                {
                    var temp = $('input[type=radio][id=radio'+i+'_'+j+']:checked').val();
                    name = temp.split('_')[0];
                    price = temp.split('_')[1];
                }
            }
            custimization.push(
            {
                'main_menu' : $('input[type=checkbox][id=chkbox'+i+']:checked').val(),
                'data' : {
                    'name' : name,
                    'price' : price,
                }
            });
        }
    }
    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/vendor/order/update_custimization',
        data:
        {
            submenu_id : $('input[type=hidden][name=submenu_id]').val(),
            custimization: custimization,
        },
        success: function (result)
        {
            var currency = $('.hidden_currency').val();
            if(result.success == true)
            {
                var price = result.data.price;
                $('#view_custimization').modal('hide');
                $('.item_total').text(currency + price);
                $('.to_pay').text(currency + price);
                $('#hidden_price').val(price);
            }
            else
            {

            }
        }
    });
}

function addUser()
{
    var user_name = $('#name').val();
    var email_id = $('#email_id').val();
    var password = $('#password').val();
    var phone = $('#phone').val();

    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/vendor/add_user',
        data:
        {
            name: user_name,
            email_id: email_id,
            password: password,
            phone: phone,
        },
        success: function (result)
        {
            if(result.success == true)
            {
                $('#user').modal('hide');
                $('select[name=user_id]').append();
                $('select[name=user_id]').append('<option value="' + result.data.id + '"'+"selected"+'>' + result.data.name + '</option>');
                $('select[name=user_id]').trigger('change');
            }
        },
        error: function (err)
        {
            console.log('err ', err)
            for (let v1 of Object.keys(err.responseJSON.errors))
            {
                $('.show_alert').show();
                $('.display').text(err.responseJSON.errors[v1]);
            }
        }
    });
}

function show_order(id)
{
    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/vendor/order/'+id,
        data:
        {
            id: id,
        },
        success: function (result)
        {
            if(result.success == true)
            {
                $('.show_order_id').text(result.data.order.order_id);
                $('.show_user_name').text(result.data.order.user.name);
                $('.show_date').text(result.data.order.date);
                $('.show_time').text(result.data.order.time);
                $('.show_admin_commission').text(result.data.currency+result.data.order.admin_commission);
                $('.show_vendor_amount').text(result.data.currency+result.data.order.vendor_amount);
                $('.show_tax').text(result.data.currency+result.data.order.tax);
                $('.show_order_table').html('');
                result.data.order.orderItems.forEach(element =>
                {
                    $('.show_order_table').append('<tr><td>'+element.itemName+'('+element.qty+')'+'</td><td>'+result.data.currency + element.price+'</td><td class="show_custimization_name'+element.id+'"></td><td class="show_custimization_price'+element.id+'"></td></tr>');
                    if (element.custimization != null)
                    {
                        element.custimization.forEach(custimization =>
                        {
                            $('.show_custimization_name'+element.id).text(custimization.data.name);
                            $('.show_custimization_price'+element.id).text(result.data.currency+custimization.data.price);
                        });
                    }
                    else
                    {
                        $('.show_custimization_name'+element.id).text("doesn't apply any custimization");
                    }
                });
                $('.show_delivery_at').text(result.data.order.delivery_type);
                $('.show_total_amount').text(result.data.currency+result.data.order.amount);
                if (result.data.order.promocode_price != null)
                {
                    $('.show_discount').text(result.data.currency+result.data.order.promocode_price);
                }
                else if(result.data.order.vendor_discount_price != null)
                {
                    $('.show_discount').text(result.data.currency+result.data.order.vendor_discount_price);
                }
                else
                {
                    $('.show_discount').text("doesn't apply any promo code");
                }
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function show_admin_order(id)
{
    $.ajax(
        {
            headers:
            {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            type: "GET",
            url: base_url + '/admin/order/'+id,
            data:
            {
                id: id,
            },
            success: function (result)
            {
                if(result.success == true)
                {
                    $('.show_order_id').text(result.data.order.order_id);
                    $('.show_user_name').text(result.data.order.user.name);
                    $('.show_date').text(result.data.order.date);
                    $('.show_time').text(result.data.order.time);
                    $('.show_admin_commission').text(result.data.currency+result.data.order.admin_commission);
                    $('.show_vendor_amount').text(result.data.currency+result.data.order.vendor_amount);
                    $('.show_order_table').html('');
                    result.data.order.orderItems.forEach(element =>
                    {
                        $('.show_order_table').append('<tr><td>'+element.itemName+'</td><td>'+result.data.currency + element.price+'</td><td class="show_custimization_name'+element.id+'"></td><td class="show_custimization_price'+element.id+'"></td></tr>');
                        if (element.custimization != null)
                        {
                            JSON.parse(element.custimization).forEach(custimization =>
                            {
                                $('.show_custimization_name'+element.id).text(custimization.custimization_name);
                                $('.show_custimization_price'+element.id).text(result.data.currency+custimization.custimization_price);
                            });
                        }
                        else
                        {
                            $('.show_custimization_name'+element.id).text("doesn't apply any custimization");
                        }
                    });
                    $('.show_delivery_at').text(result.data.order.delivery_type);
                    $('.show_total_amount').text(result.data.currency+result.data.order.amount);
                    if (result.data.order.promocode_price != null)
                    {
                        $('.show_discount').text(result.data.currency+result.data.order.promocode_price);
                    }
                    else if(result.data.order.vendor_discount_price != null)
                    {
                        $('.show_discount').text(result.data.currency+result.data.order.vendor_discount_price);
                    }
                    else
                    {
                        $('.show_discount').text("doesn't apply any promo code");
                    }
                }
            },
            error: function (err) {
                console.log('err ', err)
            }
        });
}

function view_total(id)
{
    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/vendor/order/view_total',
        data:
        {
            id: id,
        },
        success: function (result)
        {
            if(result.success == true)
            {
                var price = result.data.cart.price;
                $('.item_name').text(result.data.cart.name);
                $('.item_quantity').text(result.data.cart.qty);
                $('.item_price').text(result.data.currency + price);
                var custimization_price = 0;
                if (result.data.cart.custimization == undefined)
                {
                    $('.item_custimization').text('No custimization selected');
                }
                else
                {
                    JSON.parse(result.data.cart.custimization).forEach(element =>
                    {
                        custimization_price += parseInt(element.data.price);
                    });
                    $('.item_custimization').text(result.data.currency + custimization_price);
                }
                $('.total_bill').text(result.data.currency + (parseInt(price) + parseInt(custimization_price)));
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function show_settle_details(index)
{
    var duration = $('#duration'+index).text();
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/show_settalement/'+duration,
        success: function (result)
        {
            if(result.success == true)
            {
                $('.details_body').html('');
                $('.details_body').append('<div class="table-responsive"><table class="table"><thead class="display"><tr><th>Date</th><th>Vendor earning</th><th>Settlement with</th><th>Payment token</th></tr></thead></table></div>');
                if(result.data.length != 0)
                {
                    result.data.forEach(element =>
                    {
                        if(element.vendor_status == 1)
                        {
                            var token = element.payment_token == null ? "Payment with cod" : element.payment_token;
                            $('.display').after('<tbody><td>'+element.date+'</td><td>'+result.currency + element.vendor_earning+'</td><td>'+element.payment_type+'</td><td>'+token+'</td></tbody>');
                        }
                        else
                        {
                            $('.display').after('<tbody><td>'+element.date+'</td><td>'+result.currency + element.vendor_earning+'</td><td class="text-center" colspan=2>'+"Payment not complete"+'</td></tbody>');
                        }
                    });
                }
                else
                {
                    $('.display').after('<tbody class="text-center"><td colspan="4">No details found</td></tbody>');
                }
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function show_driver_settle_details(index,id)
{
    var duration = $('#duration'+index).text();
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/show_driver_settle_details/'+duration+'/'+id,
        success: function (result)
        {
            if(result.success == true)
            {
                $('.details_body').html('');
                $('.details_body').append('<div class="table-responsive"><table class="table"><thead class="display"><tr><th>Date</th><th>Vendor earning</th><th>Settlement with</th><th>Payment token</th></tr></thead></table></div>');
                if(result.data.length != 0)
                {
                    result.data.forEach(element =>
                    {
                        if(element.driver_status == 1)
                        {
                            var token = element.driver_payment_token == null ? "Payment with cod" : element.driver_payment_token;
                            $('.display').after('<tbody><td>'+element.date+'</td><td>'+result.currency + element.driver_earning+'</td><td>'+element.driver_payment_type+'</td><td>'+token+'</td></tbody>');
                        }
                        else
                        {
                            $('.display').after('<tbody><td>'+element.date+'</td><td>'+result.currency + element.driver_earning+'</td><td class="text-center" colspan=2>'+"Payment not complete"+'</td></tbody>');
                        }
                    });
                }
                else
                {
                    $('.display').after('<tbody class="text-center"><td colspan="4">No details found</td></tbody>');
                }
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function add_cart(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/vendor/order/add_cart/'+id,
        success: function (result)
        {
            $('.add_order').prop('disable',false);
            if(result.success == true)
            {
                var currency = $('.hidden_currency').val();
                $('.session_table tbody').append('<tr><input type="hidden" name="original_price" id="original_price'+result.data.items.id+'"value="'+result.data.items.price+'"><td>'+result.data.items.name+'</td><td><button type="button" onclick="update_cart('+result.data.items.id+',`minus`)" class="btn minus'+result.data.items.id+'"><i class="fas fa-minus"></i></button><input type="text" value="1" id="qty'+result.data.items.id+'" name="qty" readonly disabled><button type="button" onclick="update_cart('+result.data.items.id+',`plus`)" class="btn"><span><i class="fas fa-plus"></i></button></td><td>'+currency+result.data.items.price+'</td><td><a href="" onclick="view_total('+result.data.items.id+')" data-toggle="modal" onclick="view_total()" data-target="#view_total">view total</a></td><td><button type="button" onclick="removeSingleItem('+result.data.items.id+')" class="btn btn-primary removebtn m-2"><i class="fas fa-times"></i></button><a data-toggle="modal" data-target="#view_custimization" onclick="view_custimization('+result.data.items.id+')" href="#">View custimization</a></td></tr>');

                $('.item_total').text(currency + result.data.price);
                $('.to_pay').text(currency + result.data.price);
                $('#hidden_price').val(result.data.price);
            }
            else
            {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Item already exists in cart..!!'
                })
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_cart(id,operation)
{
    var qty = parseInt($('#qty' + id).val());
    if (operation == 'plus')
    {
        qty = qty + 1;
        $('#qty' + id).val(qty);
    }
    else
    {
        if (qty == 1)
        {
            $('.minus'+id).prop('disabled', true);
        }
        else
        {
            $('.minus').prop('disabled', false);
            qty = qty - 1;
            $('#qty' + id).val(qty);
        }
    }

    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/vendor/order/update_cart',
        data:
        {
            id: id,
            operation: operation,
            qty: qty,
        },
        success: function (result)
        {
            if (result.success == true)
            {
                var currency = $('.hidden_currency').val();
                var promo_id = parseInt($('.hidden_coupen_id').val());
                var delivery_charge = parseInt($('.hidden_delivery_charge').val());
                var price = result.data.price;
                $('#hidden_price').val(price);
                if(delivery_charge != 0)
                {
                    if (promo_id != 0)
                    {
                        $('.hidden_coupen_discount').val(result.data.discount);
                        $('.item_total').text(currency + price);
                        $('.to_pay').text(currency + (price + delivery_charge) - parseInt(result.data.discount));
                        $('.discount').text(currency + parseInt(result.data.discount));
                    }
                    else
                    {
                        $('.item_total').text(currency + price);
                        $('.to_pay').text(currency + (price + delivery_charge));
                    }
                }
                else
                {
                    if (promo_id != 0)
                    {
                        $('.hidden_coupen_discount').val(result.data.discount);
                        $('.item_total').text(currency + price);
                        $('.to_pay').text(currency + (price - parseInt(result.data.discount)));
                        $('.discount').text(currency + (parseInt(result.data.discount)));
                    }
                    else
                    {
                        $('.item_total').text(currency + price);
                        $('.to_pay').text(currency + price);
                    }
                }
            } else {

            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function addAddress()
{
    var user_id = $('select[name=user_id]').val();
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/admin/user_address',
        data:
        {
            lat : $('#lat').val(),
            lang : $('#lang').val(),
            address : $('.address').val(),
            user_id : user_id
        },
        success: function (result)
        {
            if(result.success == true)
            {
                $('select[name=address]').prop("disabled", false);
                $('select[name=address]').append('<option value="' + result.data.id + '"'+"selected"+'>' + result.data.address + '</option>');
                $('select[name=address]').trigger('change');
                $('#staticBackdrop').modal('hide');
            }
        },
        error: function (err)
        {
            console.log('err ', err)
        }
    });
}

function notificationTemplateEdit(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/notification_template/' + id + '/edit/',
        data:
        {
            id: id,
        },
        success: function (result) {
            if (result.success == true) {
                $('#notification_content').val(result.data.notification_content);
                $("h2").html(result.data.title);
                $('#subject').val(result.data.subject);
                $('#title').val(result.data.title);
                $('.textarea_editor').summernote('code',result.data.mail_content);
                $('.edit_notification_template_form').attr("action", base_url + "/admin/notification_template/" + result.data.id);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function removeSingleItem(id)
{
    $.ajax({
        headers: {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/vendor/order/removeSingleItem',
        data:
        {
            id: id,
        },
        success: function (result)
            {
            if (result.success == true)
            {
                swal(result.data);
                location.reload();
            }
            else {
                swal({
                    text: result.data,
                });
            }
        },
        error: function (err) {

        }
    });
}

function update_submenu(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/submenu/' + id + '/edit',
        success: function (result) {
            $('#update_submenu_form').attr("action", base_url + "/admin/submenu/" + result.data.id);
            $('#update_image').attr('src', result.data.image);
            $('#update_name').val(result.data.name);
            $('#update_price').val(result.data.price);
            $('#update_description').val(result.data.description);
            $('#type').val(result.data.type);

            if (result.data.qty_reset == 'never')
            {
                $('input[name=item_reset_value]').prop("disabled", true);
                $('input[name=item_reset_value]').val(0);
                $("#never").prop('checked', true);
            }
            else 
            {
                $('input[name=item_reset_value]').prop("disabled", false);
                $('input[name=item_reset_value]').val(result.data.item_reset_value);
                $("#daily").prop('checked', true);
            }
        },
        error: function (err) {

        }
    });
}

function update_city(id) {
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/citymanagement/' + id + '/edit',
        success: function (result)
        {
            $('#update_cutimization_form').attr("action", base_url + "/admin/citymanagement/" + result.data.id);
            $('#update_name').val(result.data.name);
        },
        error: function (err) {
        }
    });
}

function order_status(id) 
{
    $.ajax(
    {
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        data:
        {
            id : id,
            status : $('#'+id).val(),
        },
        url: base_url + '/vendor/order/change_status',
        success: function (result)
        {
            if (result.success == true)
            {
                location.reload();
            }
            else
            {

            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });     
}

function update_submenucustimization(id) {
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/customization_type/' + id + '/edit',
        success: function (result)
        {
            console.log(result);

            $('#update_cutimization_form').attr("action", base_url + "/admin/customization_type/" + result.data.id);
            $('#update_name').val(result.data.name);
            $('#update_min_item_selection').val(result.data.min_item_selection);
            $('#update_max_item_selection').val(result.data.max_item_selection);
            if (result.data.qty_reset == 'veg')
            {
                $("#veg").prop('checked', true);
            }
            else {
                $("#non-veg").prop('checked', true);
            }
        },
        error: function (err) {
        }
    });
}

function update_delivery_time()
{
    var a = $("input[name=start_time").length;
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/admin/update_delivery_time',
        success: function (result) {

        },
        error: function (err) {
        }
    });
}

function update_menu(id) {
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/menu/' + id + '/edit',
        success: function (result)
        {
            if (result.success == true)
            {
                $('#update_menu_form').attr("action", base_url + "/admin/menu/" + result.data.id);
                $('#update_image').attr('src', result.data.image);
                $('#update_menu').val(result.data.name);
                // $('#update_menu_category_id').val(result.data.menu_category_id);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_country(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/countrymanagement/' + id + '/edit',
        success: function (result) {
            console.log('result', result);
            if (result.success == true)
            {
                $('.update_country_form').attr("action", base_url + "/admin/countrymanagement/" + result.data.id);
                $('#update_name').val(result.data.name);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_state(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",
        url: base_url + '/admin/statemanagement/' + id + '/edit',
        success: function (result) {
            console.log('result', result);
            if (result.success == true)
            {
                $('.update_state_form').attr("action", base_url + "/admin/statemanagement/" + result.data.id);
                $('#update_name').val(result.data.name);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_cuisine(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",

        url: base_url + '/admin/cuisine/' + id + '/edit',
        success: function (result) {
            console.log('result', result);
            if (result.success == true)
            {
                $('#update_image').attr('src', result.data.image);
                $('#update_cuisine_form').attr("action", base_url + "/admin/cuisine/" + result.data.id);
                $('#update_cuisine').val(result.data.name);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function update_banner(id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "GET",

        url: base_url + '/admin/banner/' + id + '/edit',
        success: function (result) {
            console.log('result', result);
            if (result.success == true)
            {
                $('#update_banner_form').attr("action", base_url + "/admin/banner/" + result.data.id);
                $('#update_image').attr('src', result.data.image);
                $('#update_name').val(result.data.name);
            }
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function change_selling_timeslot(url,id)
{
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/' + url + '/selling_timeslot',
        data:
        {
            id: id,
        },
        success: function (result) {
            iziToast.success({
                message: 'Change timeslots successfully..!!',
                position: 'topRight',
                })
        },
        error: function (err) {
            console.log('err ', err)
        }
    });
}

function change_status(url, id)
{
    console.log(base_url + '/' + url + '/change_status');
    $.ajax({
        headers:
        {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        type: "POST",
        url: base_url + '/' + url + '/change_status',
        data:
        {
            id: id,
        },
        success: function (result)
        {
            iziToast.success({
            message: 'Change status successfully..!!',
            position: 'topRight',
            })
        },
        error: function (err) {

        }
    });
}

function deleteData(url, id)
{
    Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
      }).then((result) => {
        if (result.value)
        {
            console.log(base_url + '/' + url + '/' + id);
            $.ajax({
                headers:
                {
                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                },
                type: "DELETE",
                dataType: "JSON",
                url: base_url + '/' + url + '/' + id,
                success: function (result)
                {
                    console.log(result);
                    if (result.success == true)
                    {
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                        console.log('result ', result)
                        Swal.fire(
                            'Deleted!',
                            'Your file has been deleted.',
                            'success'
                          )
                    }
                    else {
                        console.log(result);
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'This data is connected with another data'
                        })
                    }
                },
                error: function (err) {
                    console.log('err ', err)
                    Swal.fire({
                        type: 'error',
                        title: 'Oops...',
                        text: 'This record is conntect with another data!'
                    })
                }
            });
        }
    });
}
